<!DOCTYPE html><html><head><title>Imp | NodObjC v0.0.11</title><link href="assets/styles.css" rel="stylesheet"><link href="assets/ir_black.css" rel="stylesheet"><script src="assets/jquery-1.7.1.js" type="text/javascript"></script><script src="assets/script.js" type="text/javascript"></script></head><body><div id="content"><a href="index.html" id="title"><h1>NodObjC</h1><h3>The NodeJS &#8646; Objective-C Bridge</h3></a><div class="toc"><span class="page"><a href="block.html">block</a></span><span class="page"><a href="bridgesupport.html">bridgesupport</a></span><span class="page"><a href="class.html">class</a></span><span class="page"><a href="core.html">core</a></span><span class="page"><a href="exception.html">exception</a></span><span class="page"><a href="ffi-extend.html">ffi-extend</a></span><span class="page"><a href="id.html">id</a></span><span class="page"><a href="imp.html">imp</a></span><span class="page"><a href="import.html">import</a></span><span class="page"><a href="index.html">index</a></span><span class="page"><a href="ivar.html">ivar</a></span><span class="page"><a href="method.html">method</a></span><span class="page"><a href="sel.html">sel</a></span><span class="page"><a href="struct.html">struct</a></span><span class="page"><a href="types.html">types</a></span></div><h2>Imp</h2><div class="part"><div class="desc"><p>Represents a wrapped <code>IMP</code> (a.k.a. method implementation). <code>IMP</code>s are function pointers for methods. The first two arguments are always:

</p>
<ol>
<li><code>self</code> - The object instance the method is being called on.</li>
<li><code>_cmd</code> - The <code>SEL</code> selector of the method being invoked.</li>
</ol>
<p>Any additional arguments that get passed are the actual arguments that get
passed along to the method.</p>
</div></div><div class="part"><h3>createWrapperPointer()</h3><div class="desc"><div class="private"><div class="caution"></div>This is a private function used internally by <code>NodObjC</code>. You should <b>not</b> need to use this function in
your code.</div><p>Creates an ffi Function Pointer to the passed in &#39;func&#39; Function. The
function gets wrapped in an &quot;wrapper&quot; function, which wraps the passed in
arguments, and unwraps the return value.
</p>
</div><button class="show-code">Show Code</button><pre class="code"><code><span class="function"><span class="keyword">function</span> <span class="title">createWrapperPointer</span> <span class="params">(func, type)</span> {</span>
  <span class="keyword">if</span> (func.pointer) {
    debug(<span class="string">'Detected an \'unwrapper\' function, returning original pointer'</span>)
    <span class="keyword">return</span> func.pointer
  }
  <span class="keyword">var</span> rtnType = type.retval || type[<span class="number">0</span>] || <span class="string">'v'</span>
    , argTypes = type.args || type[<span class="number">1</span>] || []
    , ffiDef = [types.map(rtnType), types.mapArray(argTypes)]
    , ffiCb = <span class="keyword">new</span> core.Callback(ffiDef, wrapper)
  <span class="function"><span class="keyword">function</span> <span class="title">wrapper</span> <span class="params">()</span> {</span>
    <span class="keyword">var</span> args = core.wrapValues(arguments, argTypes)
      , rtn = func.apply(<span class="literal">null</span>, args)
    <span class="keyword">return</span> core.unwrapValue(rtn, rtnType)
  }
  <span class="keyword">return</span> ffiCb.getPointer()
}</code></pre></div><div class="part"><h3>createUnwrapperFunction()</h3><div class="desc"><div class="private"><div class="caution"></div>This is a private function used internally by <code>NodObjC</code>. You should <b>not</b> need to use this function in
your code.</div><p>Creates a JS Function from the passed in function pointer. When the returned
function is invoked, the passed in arguments are unwrapped before being
passed to the native function, and the return value is wrapped up before
being returned for real.
</p>
</div><button class="show-code">Show Code</button><pre class="code"><code><span class="function"><span class="keyword">function</span> <span class="title">createUnwrapperFunction</span> <span class="params">(funcPtr, type)</span> {</span>
  <span class="keyword">var</span> rtnType = type.retval || type[<span class="number">0</span>] || <span class="string">'v'</span>
    , argTypes = type.args || type[<span class="number">1</span>] || []
    , func = core.ForeignFunction.build(funcPtr
                                      , types.map(rtnType)
                                      , types.mapArray(argTypes))
  <span class="function"><span class="keyword">function</span> <span class="title">unwrapper</span> <span class="params">()</span> {</span>
    <span class="keyword">var</span> args = core.unwrapValues(arguments, argTypes)
      , rtn = func.apply(<span class="literal">null</span>, args)
    <span class="keyword">return</span> core.wrapValue(rtn, rtnType)
  }
  unwrapper.retval = rtnType
  unwrapper.args = argTypes
  unwrapper.pointer = funcPtr
  <span class="keyword">return</span> unwrapper
}</code></pre></div></div><div id="footer">NodObjC &copy; 2011-2012 Nathan Rajlich. Documentation generated by <a href="https://github.com/visionmedia/dox">dox</a>.</div><a href="http://github.com/TooTallNate/NodObjC"><img id="ribbon" src="https://a248.e.akamai.net/camo.github.com/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub"></a></body></html>
